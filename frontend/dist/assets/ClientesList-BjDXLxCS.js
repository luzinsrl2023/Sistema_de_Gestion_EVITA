import{c as I,h as O,r as n,u as K,R as Q,j as e,M as W,i as Y,f as S,k as Z,d as ee,l as ae,P as te,S as se,C as le,F as re,m as P,D as ne,n as oe,o as ie,X as ce,p as de,b as k,q as me,s as ue,g as he,e as xe}from"./index-DfmaiBAy.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=I("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=I("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),z=[{id:"CLI001",name:"Juan Pérez",email:"juan.perez@example.com",phone:"(555) 123-4567",totalPurchases:1250,lastPurchase:"2023-11-15",paymentStatus:"pagado",status:"activo"},{id:"CLI002",name:"Ana Gómez",email:"ana.gomez@example.com",phone:"(555) 987-6543",totalPurchases:875,lastPurchase:"2023-10-20",paymentStatus:"pendiente",status:"activo"},{id:"CLI003",name:"Carlos Rodríguez",email:"carlos.rodriguez@example.com",phone:"(555) 246-8013",totalPurchases:2100,lastPurchase:"2023-12-01",paymentStatus:"pagado",status:"activo"},{id:"CLI004",name:"Laura Fernández",email:"laura.fernandez@example.com",phone:"(555) 369-1215",totalPurchases:550,lastPurchase:"2023-11-28",paymentStatus:"pagado",status:"bloqueado"},{id:"CLI005",name:"David Martínez",email:"david.martinez@example.com",phone:"(555) 482-3457",totalPurchases:1500,lastPurchase:"2023-12-05",paymentStatus:"pagado",status:"activo"},{id:"CLI006",name:"Sofía López",email:"sofia.lopez@example.com",phone:"(555) 605-5679",totalPurchases:300,lastPurchase:"2023-11-20",paymentStatus:"vencido",status:"activo"},{id:"CLI007",name:"Javier Sánchez",email:"javier.sanchez@example.com",phone:"(555) 728-7891",totalPurchases:1800,lastPurchase:"2023-12-10",paymentStatus:"pagado",status:"activo"}];function ye(){const{data:o=[],addCliente:L}=O(),[d,m]=n.useState(o.length?o:z),[i,b]=n.useState(o.length?o:z),[c,j]=n.useState(""),[u,T]=n.useState("all"),[D,h]=n.useState(!1),[x,y]=n.useState([]),[r,g]=n.useState({name:"",email:"",phone:"",address:""}),v=n.useRef(null);n.useEffect(()=>{o.length&&(m(o),b(o))},[o]);const C=K();n.useEffect(()=>{const a=new URLSearchParams(C.search).get("q")||"";j(a)},[C.search]),n.useEffect(()=>{let a=d;c&&(a=a.filter(t=>t.name.toLowerCase().includes(c.toLowerCase())||t.email.toLowerCase().includes(c.toLowerCase())||t.id.toLowerCase().includes(c.toLowerCase()))),u!=="all"&&(a=a.filter(t=>t.paymentStatus===u)),b(a)},[c,u,d]);const F=a=>{y(t=>t.includes(a)?t.filter(s=>s!==a):[...t,a])},A=()=>{x.length===i.length?y([]):y(i.map(a=>a.id))},q=a=>{const t=de(a),s={pagado:"Pagado",pendiente:"Pendiente",vencido:"Vencido"};return e.jsxs("span",{className:k("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-medium",t),children:[e.jsx("span",{className:"w-2 h-2 mr-2 rounded-full bg-current"}),s[a]||a]})},H=a=>{const t=a==="activo";return e.jsxs("span",{className:k("inline-flex items-center rounded-full px-2.5 py-1 text-xs font-medium",t?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"),children:[e.jsx("span",{className:"w-2 h-2 mr-2 rounded-full bg-current"}),t?"Activo":"Bloqueado"]})},R=Q.useMemo(()=>[{id:"select",Header:()=>e.jsx("input",{type:"checkbox",checked:x.length===i.length&&i.length>0,onChange:A,className:"rounded border-gray-600 text-green-600 focus:ring-green-500 focus:ring-offset-gray-900"}),Cell:({row:a})=>e.jsx("input",{type:"checkbox",checked:x.includes(a.original.id),onChange:()=>F(a.original.id),className:"rounded border-gray-600 text-green-600 focus:ring-green-500 focus:ring-offset-gray-900"}),disableSortBy:!0},{Header:"Cliente",accessor:"name",Cell:({row:a})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-700 rounded-lg",children:e.jsx(E,{className:"h-4 w-4 text-gray-300"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:a.original.name}),e.jsx("p",{className:"text-xs text-gray-400",children:a.original.id})]})]})},{Header:"Contacto",accessor:"email",Cell:({row:a})=>e.jsxs("div",{className:"space-y-1 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-3 w-3"}),a.original.email]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-3 w-3"}),a.original.phone]})]})},{Header:"Total Compras",accessor:"totalPurchases",Cell:({value:a})=>e.jsx("span",{className:"text-sm text-white font-mono",children:S(a)})},{Header:"Última Compra",accessor:"lastPurchase",Cell:({value:a})=>e.jsx("span",{className:"text-sm text-gray-400",children:Z(a)})},{Header:"Estado Pago",accessor:"paymentStatus",Cell:({value:a})=>e.jsx(e.Fragment,{children:q(a)})},{Header:"Estado",accessor:"status",Cell:({value:a})=>e.jsx(e.Fragment,{children:H(a)})},{id:"actions",Header:"Acciones",Cell:({row:a})=>e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>J(a.original.id),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:a.original.status==="activo"?e.jsx(ge,{className:"h-4 w-4"}):e.jsx(E,{className:"h-4 w-4"})}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(ae,{className:"h-4 w-4"})})]}),disableSortBy:!0}],[i,x]),B=()=>{const a=i.map(t=>({"ID Cliente":t.id,Nombre:t.name,Email:t.email,Teléfono:t.phone,"Total Compras":t.totalPurchases,"Última Compra":t.lastPurchase,"Estado Pago":t.paymentStatus,"Estado Cliente":t.status}));me({filename:"clientes_evita.xlsx",sheetName:"Clientes",data:a})},M=()=>{const a=["ID","Nombre","Email","Teléfono","Total Compras","Última Compra","Estado Pago","Estado"],t=i.map(s=>[s.id,s.name,s.email,s.phone,S(s.totalPurchases),s.lastPurchase,s.paymentStatus,s.status]);ue({title:"Reporte de Clientes - EVITA",head:a,body:t,filename:"clientes_evita.pdf"})},U=()=>{var a;(a=v.current)==null||a.click()},_=a=>{const t=a.target.files[0];if(t){const s=new FileReader;s.onload=p=>{try{const f=new Uint8Array(p.target.result),N=he(f,{type:"array"}),V=N.SheetNames[0],X=N.Sheets[V],w=xe.sheet_to_json(X).map((l,G)=>({id:l["ID Cliente"]||l.id||`CLI${(d.length+G+1).toString().padStart(3,"0")}`,name:l.Nombre||l.name||"",email:l.Email||l.email||"",phone:l.Teléfono||l.phone||"",totalPurchases:parseFloat(l["Total Compras"]||l.totalPurchases||0),lastPurchase:l["Última Compra"]||l.lastPurchase||new Date().toISOString().split("T")[0],paymentStatus:l["Estado Pago"]||l.paymentStatus||"pendiente",status:l["Estado Cliente"]||l.status||"activo"}));m(l=>[...l,...w]),alert(`Se importaron ${w.length} clientes exitosamente`)}catch(f){alert("Error al procesar el archivo Excel"),console.error("Import error:",f)}},s.readAsArrayBuffer(t)}a.target.value=""},$=async()=>{if(r.name&&r.email){const t={id:`CLI${(d.length+1).toString().padStart(3,"0")}`,name:r.name,email:r.email,phone:r.phone,totalPurchases:0,lastPurchase:new Date().toISOString().split("T")[0],paymentStatus:"pendiente",status:"activo"};try{await L(t)}catch{}m(s=>[...s,t]),g({name:"",email:"",phone:"",address:""}),h(!1),alert("Cliente agregado exitosamente")}else alert("Por favor complete los campos obligatorios (Nombre y Email)")},J=a=>{m(t=>t.map(s=>{if(s.id===a){const p=s.status==="activo"?"bloqueado":"activo";return alert(`Cliente ${p==="bloqueado"?"bloqueado":"desbloqueado"} exitosamente`),{...s,status:p}}return s}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Gestión de Clientes"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Administra la información de tus clientes, su historial de compras y estado de pago."})]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",children:[e.jsx(te,{className:"h-4 w-4"}),"Agregar Cliente"]})]}),e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-xl",children:[e.jsxs("div",{className:"p-4 border-b border-gray-800 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsxs("div",{className:"relative max-w-md flex-1",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"search",placeholder:"Buscar cliente por nombre o ID",value:c,onChange:a=>j(a.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg pl-10 pr-4 py-2 text-sm text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:u,onChange:a=>T(a.target.value),className:"bg-gray-800 border border-gray-700 text-white rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-500 appearance-none pr-8",children:[e.jsx("option",{value:"all",children:"Todos los estados"}),e.jsx("option",{value:"pagado",children:"Pagado"}),e.jsx("option",{value:"pendiente",children:"Pendiente"}),e.jsx("option",{value:"vencido",children:"Vencido"})]}),e.jsx(le,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(re,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:U,className:"flex items-center gap-2 bg-gray-700 hover:bg-gray-600 text-white px-3 py-2 rounded-lg text-sm font-medium transition-colors",children:[e.jsx(P,{className:"h-4 w-4"}),"Importar Excel"]}),e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-gray-800 border border-gray-700 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50",children:[e.jsxs("button",{onClick:B,className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-white hover:bg-gray-700 transition-colors",children:[e.jsx(P,{className:"h-4 w-4"}),"Exportar Excel"]}),e.jsxs("button",{onClick:M,className:"flex items-center gap-2 w-full px-3 py-2 text-sm text-white hover:bg-gray-700 transition-colors",children:[e.jsx(oe,{className:"h-4 w-4"}),"Exportar PDF"]})]})]})]})]}),e.jsx("input",{ref:v,type:"file",accept:".xlsx,.xls",onChange:_,className:"hidden"}),e.jsx(ie,{columns:R,data:i,pageSize:10})]}),D&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:e.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Nuevo Cliente"}),e.jsx("button",{onClick:()=>h(!1),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(ce,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Nombre Completo *"}),e.jsx("input",{type:"text",required:!0,value:r.name,onChange:a=>g({...r,name:a.target.value}),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Ej. Juan Pérez"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:r.email,onChange:a=>g({...r,email:a.target.value}),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"juan.perez@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:"Teléfono"}),e.jsx("input",{type:"tel",value:r.phone,onChange:a=>g({...r,phone:a.target.value}),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"(555) 123-4567"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg font-medium transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:$,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:"Agregar Cliente"})]})]})]})})]})}export{ye as default};
